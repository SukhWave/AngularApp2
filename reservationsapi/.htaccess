<IfModule mod_rewrite.c>
  RewriteEngine On

  # ✅ Handle OPTIONS requests (CORS preflight)
  RewriteCond %{REQUEST_METHOD} OPTIONS
  RewriteRule ^(.*)$ $1 [R=200,L]

  # ✅ Clean URLs: rewrite to .php if file doesn't exist
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteRule ^([^\.]+)$ $1.php [NC,L]

  # ✅ Skip rewrite for /uploads/ folder (serve actual files)
  RewriteCond %{REQUEST_URI} ^/uploads/ [NC]
  RewriteCond %{REQUEST_FILENAME} -f
  RewriteRule ^ - [L]

  # ✅ Repeat clean URL rule (optional but safe)
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteRule ^([^\.]+)$ $1.php [NC,L]
</IfModule>

<IfModule mod_headers.c>
  Header always set Access-Control-Allow-Origin "http://localhost:4200"
  Header always set Access-Control-Max-Age "1000"
  Header always set Access-Control-Allow-Headers "X-Requested-With, Content-Type, Origin, Authorization, Accept, Client-Security-Token, Accept-Encoding"
  Header always set Access-Control-Allow-Methods "POST, GET, OPTIONS, DELETE, PUT"
</IfModule>

# ✅ Directory access rules
Options Indexes FollowSymLinks
Require all granted
